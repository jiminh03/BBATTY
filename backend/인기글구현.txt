main서버의 post에서는 좋아요, 조회수, 댓글 이벤트가 생성될 때마다 이벤트를 생성시킨다.
schdule서버에서는 10분에 한번씩 카프카에 쌓인 이벤트를 받아서 redis의 인기글 랭킹을 갱신시킨다.
참고로 인기글의 경우 각각 팀마다 20개씩의 순위로 계산되며 redis의 zset으로 저장된다.
참고로 위의 main과 schedule가 생산자 소바자이고 처리하는 서버는 1대씩이다
좋아요 → 즉시 랭킹 반영 (실시간) 조회수 → 10분마다 배치 (현재) 댓글 → 1시간마다 배치 (느린 처리)